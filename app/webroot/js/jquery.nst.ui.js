!function(t){t.fn.nstUI=function(o){var e={method:"",tableRowCss:{even:"even",odd:"odd"},lightbox:{opacity:.75},loadAjax:{url:"",data:"",field:{load:"",show:""},datatype:"html",event_complete:"",event_error:""},formAction:{action:"",field_load:"",submit:!1,event_submit:"",event_error:"",event_complete:"",loading:!1},verifyAction:{field:"",event_complete:""},confirmAction:{field_load:"",event_complete:""},placeholder:{},toggleTab:{field:"",effect:"",duration:0},toggleAction:{},tooltip:{},dropdown:{},copyValue:{from:"",to:""},accordion:{type:""},tabs:{class_active:"active",effect:"",duration:0},moreList:{item:"",num:0},moreBlock:{}},i=t.extend({},e,o);return t(this).each(function(){function o(){k.find("tr:even").addClass(i.tableRowCss.even),k.find("tr:odd").addClass(i.tableRowCss.odd)}function n(){var o=new Array,n=k.attr("href"),a=n.split("?lightbox&");if(a[1])for(var r=a[1].split("&"),c=0;c<r.length;c++){var l=r[c].split("=");l[1]&&("true"==l[1]?l[1]=!0:"false"==l[1]&&(l[1]=!1),o[l[0]]=l[1])}return o.href=a[0],i.lightbox=t.extend({},e.lightbox,o),k.colorbox(i.lightbox),!1}function a(){var o=i.loadAjax.url,e=i.loadAjax.field;return o?(w("show",e.load),t.post(o,i.loadAjax.data,function(t){w("hide",e.load),w("result",e.show,t),"function"==typeof i.loadAjax.event_complete&&i.loadAjax.event_complete.call(this,t,i.loadAjax)},i.loadAjax.datatype).error(function(){w("hide",e.load),w("error",e.show,o),"function"==typeof i.loadAjax.event_error&&i.loadAjax.event_error.call(this,i.loadAjax)}),!1):!1}function r(){var o=t(this),e=o.attr("name");if(e){var i=o.attr("value");i=i?i:"";var n=k.find("[name="+e+"_autocheck]");n.html('<div id="loader"></div>').show();var a=k.attr("action");a=void 0==a||""==a?window.location.href:a;var r="_autocheck="+e+"&"+k.serialize();t.post(a,r,function(t){var o=k.find("[name="+e+"_error]");t.accept?(n.html('<div id="accept"></div>').show(),o.html(t.error).hide("blind")):(n.html('<div id="error"></div>').show(),o.html(t.error).show("blind",200))},"json").error(function(t,o,i){var a=k.find("[name="+e+"_error]");n.hide(),a.hide()})}}function c(){if(i.formAction.loading)return!1;i.formAction.loading=!0,w("show",i.formAction.field_load),"function"==typeof i.formAction.event_submit&&i.formAction.event_submit.call(this,i.formAction);var o=i.formAction.action;o=o?o:k.attr("action"),o=void 0==o||""==o?window.location.href:o;var e="_submit=true&"+k.serialize();return t.post(o,e,function(t){l(t)},"json").error(function(t,o,e){l()}),!1}function l(o){return i.formAction.loading=!1,w("hide",i.formAction.field_load),void 0==o?void alert("Có lỗi xẩy ra trong qua trình xử lý"):(k.find("[name$=_error]").html(""),void(o.complete?"function"==typeof i.formAction.event_complete?i.formAction.event_complete.call(this,o,i.formAction):void 0!=o.location?o.location?window.parent.location=o.location:window.location.reload():void 0!=o.color_box?o.color_box&&t.colorbox({href:o.color_box_url}):void 0!=o.msg&&(o.msg&&alert(o.msg),void 0!=o.reset_form&&t(".form_action").trigger("reset")):(t.each(o,function(t,o){k.find("[name="+t+"_error]").html(o).show("blind",200)}),"function"==typeof i.formAction.event_error&&i.formAction.event_error.call(this,o,i.formAction))))}function d(){var o=i.verifyAction.field;o=o?o:"verify_action";var e=t("#"+o),n=t(this).attr("_url");return n=n?n:t(this).attr("href"),e.find("#notice").html(t(this).attr("notice")),e.find("#accept").attr("url",n),t.colorbox({inline:!0,href:"#"+o,opacity:.75}),e.find("#accept").click(function(){var e=t(this).attr("url");return e?(t(this).nstUI({method:"loadAjax",loadAjax:{url:e,field:{load:o+"_load"},event_complete:function(o,e){t.colorbox.close(),"function"==typeof i.verifyAction.event_complete?i.verifyAction.event_complete.call(this,o,i.verifyAction):window.location.reload()},event_error:function(o){t.colorbox.close()}}}),!1):(t.colorbox.close(),!1)}),e.find("#cancel").click(function(){return t.colorbox.close(),!1}),!1}function f(){var t=k.attr("_url");if(t=t?t:k.attr("href"),!t)return!1;var o=k.attr("_notice");return 1==confirm(o)&&k.nstUI({method:"loadAjax",loadAjax:{url:t,field:{load:i.confirmAction.field_load,show:""},event_complete:function(t,o){"function"==typeof i.confirmAction.event_complete?i.confirmAction.event_complete.call(this,t,i.confirmAction):window.location.reload()},event_error:function(t){window.location.reload()}}}),!1}function s(){if(!k.val()){var t=k.attr("placeholder");k.val(t)}k.focus(function(){var t=k.attr("placeholder");k.val()==t&&k.val("")}).blur(function(){if(!k.val()){var t=k.attr("placeholder");k.val(t)}})}function u(){function o(){r.find("[_"+e+"]").hide();var t=k.val();""!=t&&(r.find("[_"+e+"="+t+"]").show(),r.show(n,a))}var e=i.toggleTab.field,n=i.toggleTab.effect,a=i.toggleTab.duration,r=t("#"+e);n=n?n:"blind",a=a?a:300,"none"!=r.css("display")?r.hide(n,a,function(){o()}):o()}function v(){function o(t){t?k.addClass("on"):k.removeClass("on"),e(t?!1:!0)}function e(t){void 0==t&&(t=k.hasClass("on")?!1:!0);var o=t?"on":"off",e=k.attr("_title_"+o);k.attr("title",e)}e(),k.click(function(){var e=k.hasClass("on")?"off":"on",i=k.attr("_url_"+e);if(!i)return!1;var n="on"==e?!0:!1;return o(n),t.post(i,function(t){t.complete||o(n?!1:!0)},"json").error(function(){o(n?!1:!0)}),!1})}function h(){k.hover(function(){var t=k.attr("_tooltip");k.find("#"+t).stop(!0,!0).slideDown(200)},function(){var t=k.attr("_tooltip");k.find("#"+t).stop(!0,!0).slideUp(200)})}function m(){var o="#"+k.attr("_dropdown"),e=t(o),i=k.attr("_dropdown_effect");i=i?i:"blind",k.click(function(){e.stop(!0,!0).toggle(i,200)}),t(document).bind("click",function(t){if("none"!=e.css("display")){var o=t.target;k[0]!=o&&void 0==k.find(o)[0]&&e[0]!=o&&void 0==e.find(o)[0]&&e.stop(!0,!0).hide(i,200)}})}function _(){var o=t("#"+i.copyValue.from),e=t("#"+i.copyValue.to);return o.find("[_param]").each(function(){var o=t(this).attr("_param"),i=t(this).val();e.find("[_param="+o+"]").val(i)}),!1}function b(){k.find("[_title]").click(function(){var o=t(this),e=o.attr("_title");switch(i.accordion.type){case"2":o.toggleClass("acc_active"),k.find("[_title][_title!="+e+"]").removeClass("acc_active"),k.find("[_body="+e+"]").stop(!0,!0).slideToggle(),k.find("[_body][_body!="+e+"]").stop(!0,!0).slideUp();break;default:o.toggleClass("acc_active").siblings("[_title]").removeClass("acc_active"),o.siblings("[_body="+e+"]").stop(!0,!0).slideToggle().siblings("[_body]").stop(!0,!0).slideUp()}return!1})}function p(){function o(t){k.find(".tab").removeClass(e),k.find(".tab#"+t).addClass(e),k.find(".tab_content").hide(),k.find(".tab_content#"+t+"_content").show(n,a)}var e=i.tabs.class_active,n=i.tabs.effect,a=i.tabs.duration,r=k.find(".tab."+e).attr("id");r=r?r:k.find(".tab:first").attr("id"),o(r),k.find(".tab").click(function(){if(!t(this).hasClass(e)){var i=t(this).attr("id");o(i)}return!1})}function g(){function o(o){k.find(n).each(function(o){a>o?t(this).show():t(this).hide()}),r.show(),c.hide(),o&&t.scrollTo(k.find(n),800)}function e(){k.find(n).show(),r.hide(),c.show()}var n=i.moreList.item,a=i.moreList.num,r=k.find("#act_all"),c=k.find("#act_short");return o(!1),r.click(function(){return e(),!1}),c.click(function(){return o(!0),!1}),!1}function A(){function o(o){k.removeClass("block_all"),o&&t.scrollTo(k,800)}function e(){k.addClass("block_all")}var i=k.find("#block_act_all"),n=k.find("#block_act_short");return i.click(function(){return e(),!1}),n.click(function(){return o(!1),!1}),!1}function w(o,e,i){switch(o){case"show":e?t("#"+e).html('<div id="loader"></div>').hide().fadeIn("fast"):(t("body").append('<div id="overlay"></div><div id="preloader">Đang xử lý...</div>'),t("#overlay, #preloader").hide().fadeIn("fast"));break;case"hide":e?t("#"+e).fadeOut("fast"):t("#overlay, #preloader").fadeOut("fast",function(){t(this).remove()});break;case"result":if(!e)return;t("#"+e).html(i).show();break;case"error":if(!e)return;t("#"+e).html("Không tìm thấy liên kết: <b>"+i+"</b>").hide().fadeIn("fast")}}var k=t(this);switch(i.method){case"tableRowCss":o();break;case"lightbox":n();break;case"loadAjax":a();break;case"formAction":i.formAction.submit?c():(k.submit(c),k.find("input[type=submit]").click(c),k.find("[_autocheck]").change(r));break;case"verifyAction":k.click(d);break;case"confirmAction":k.click(f);break;case"placeholder":s();break;case"toggleTab":u(),k.change(function(){u()});break;case"toggleAction":v();break;case"tooltip":h();break;case"dropdown":m();break;case"copyValue":_();break;case"accordion":b();break;case"tabs":p();break;case"moreList":g();break;case"moreBlock":A();break;default:alert("Không tìm thấy thuộc tính: "+i.method)}})}}(jQuery);